<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Music Web — Spotify-like</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    
    :root {
      --bg: #121212;
      --panel: #181818;
      --panel-2: #0f0f0f;
      --text: #fff;
      --muted: #b3b3b3;
      --brand: #1db954; /* Spotify green */
      --brand-2: #1ed760;
      --hover: #2a2a2a;
      --border: #2b2b2b;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(180deg, #0f0f0f 0%, #121212 40%, #0e0e0e 100%);
      color: var(--text);
      overflow: hidden;
    }

    /* Layout */
    .app {
      display: grid;
      grid-template-columns: 260px 1fr;
      grid-template-rows: 1fr auto;
      grid-template-areas:
        "sidebar main"
        "player player";
      height: 100vh;
      width: 100vw;
    }

    .sidebar {
      grid-area: sidebar;
      background: var(--panel);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 14px;
      padding: 18px 16px;
    }
    .logo {
      display: flex; align-items: center; gap: 10px;
      font-weight: 700; letter-spacing: .2px;
    }
    .logo-badge {
      width: 28px; height: 28px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, var(--brand-2), var(--brand) 60%, #0c7a36 100%);
      display: grid; place-items: center;
      box-shadow: 0 0 20px rgba(29,185,84,.4);
    }
    .menu { display: grid; gap: 6px; margin-top: 6px; }
    .menu a {
      text-decoration: none; color: var(--muted);
      padding: 10px 12px; border-radius: 8px;
      display: flex; align-items: center; gap: 10px;
    }
    .menu a.active, .menu a:hover {
      background: var(--hover);
      color: var(--text);
    }

    .main {
      grid-area: main;
      display: grid;
      grid-template-rows: auto 1fr;
      min-width: 0;
    }

    .topbar {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 22px; border-bottom: 1px solid var(--border);
      background: rgba(18,18,18,.6);
      backdrop-filter: blur(6px);
      position: sticky; top: 0; z-index: 5;
    }

    .search {
      display: flex; align-items: center; gap: 10px;
      background: var(--panel);
      padding: 10px 14px; border-radius: 999px;
      border: 1px solid var(--border);
      width: min(560px, 90%);
    }
    .search input {
      background: transparent; border: 0; outline: 0; color: var(--text);
      width: 100%; font-size: 14px;
    }

    .main-scroll {
      overflow: auto;
    }

    .section-title {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 22px 8px;
    }

    /* Playlist */
    .playlist {
      width: 100%;
      border-collapse: collapse;
    }
    .playlist thead th {
      text-align: left; color: var(--muted); font-weight: 500; font-size: 12px; letter-spacing: .6px;
      padding: 10px 22px; border-bottom: 1px solid var(--border);
    }
    .playlist tbody tr {
      transition: background .15s ease;
    }
    .playlist tbody tr:hover { background: var(--hover); }
    .playlist td {
      padding: 10px 22px; vertical-align: middle; border-bottom: 1px solid var(--border);
      font-size: 14px;
    }

    .track {
      display: grid;
      grid-template-columns: 48px 1fr auto;
      gap: 12px; align-items: center;
      min-width: 0;
    }
    .cover {
      width: 48px; height: 48px; border-radius: 6px; overflow: hidden;
      background: #222; flex: 0 0 auto;
    }
    .cover img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .meta { min-width: 0; }
    .title { font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .artist { color: var(--muted); font-size: 12px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .duration { color: var(--muted); font-variant-numeric: tabular-nums; }

    /* Player */
    .player {
      grid-area: player;
      background: var(--panel-2);
      border-top: 1px solid var(--border);
      display: grid; grid-template-columns: 1fr 2fr 1fr; align-items: center;
      gap: 16px; padding: 10px 16px;
    }
    .now-playing { display: flex; align-items: center; gap: 12px; min-width: 0; }
    .np-cover { width: 56px; height: 56px; border-radius: 8px; overflow: hidden; background: #222; }
    .np-cover img { width: 100%; height: 100%; object-fit: cover; display: block; }
    .np-text { min-width: 0; }
    .np-title { font-size: 14px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .np-artist { font-size: 12px; color: var(--muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    .controls { display: grid; place-items: center; gap: 10px; }
    .ctrl-row { display: flex; align-items: center; gap: 14px; }
    .btn {
      appearance: none; border: 0; background: transparent; color: var(--text);
      width: 36px; height: 36px; border-radius: 999px; display: grid; place-items: center; cursor: pointer;
    }
    .btn.icon:hover { background: rgba(255,255,255,.06); }
    .btn.play {
      width: 44px; height: 44px; background: var(--text); color: var(--bg); box-shadow: 0 0 0 4px rgba(255,255,255,.05);
    }
    .btn.play.toggled { background: var(--brand); color: #000; }

    .seek {
      display: flex; align-items: center; gap: 10px; width: min(640px, 90vw);
      font-variant-numeric: tabular-nums; color: var(--muted); font-size: 12px;
    }
    .bar {
      position: relative; height: 6px; background: #2a2a2a; border-radius: 999px; flex: 1; cursor: pointer;
    }
    .bar-fill { position: absolute; left: 0; top: 0; bottom: 0; width: 0%; background: var(--brand); border-radius: 999px; }
    .bar knob, .knob {
      position: absolute; top: 50%; transform: translate(-50%,-50%);
      width: 12px; height: 12px; border-radius: 50%; background: var(--text); box-shadow: 0 0 8px rgba(29,185,84,.6);
      left: 0%;
    }

    .right { display: flex; align-items: center; justify-content: flex-end; gap: 12px; }
    .volume { display: flex; align-items: center; gap: 10px; width: 160px; }

    .chip {
      font-size: 12px; color: #000; background: var(--brand); padding: 4px 8px; border-radius: 999px; font-weight: 700;
    }

    /* Responsive */
    @media (max-width: 980px) {
      .app { grid-template-columns: 0 1fr; }
      .sidebar { display: none; }
      .player { grid-template-columns: 1fr; grid-auto-rows: auto; }
      .controls { order: -1; }
      .right { justify-content: center; }
    }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="logo">
        <div class="logo-badge">♪</div>
        <div>Musik <span class="chip">Beta</span></div>
      </div>
      <nav class="menu">
        <a class="active" href="#">Beranda</a>
        <a href="#">Playlist</a>
        <a href="#">Favorit</a>
      </nav>
      <div style="margin-top:auto; color:var(--muted); font-size:12px">
        Tambahkan lagu langsung di kode JS (array <code>tracks</code>), bukan lewat UI.
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="10" cy="10" r="6" stroke="currentColor" stroke-width="2"/></svg>
          <input id="search" type="text" placeholder="Cari judul atau artist…" />
        </div>
      </div>

      <div class="section-title">
        <h2 style="margin:0">Daftar Lagu</h2>
        <span style="color:var(--muted); font-size:13px" id="totalCount">0 lagu</span>
      </div>

      <div class="main-scroll">
        <table class="playlist">
          <thead>
            <tr>
              <th style="width: 56px;">#</th>
              <th>Lagu</th>
              <th>Waktu</th>
            </tr>
          </thead>
          <tbody id="playlistBody"></tbody>
        </table>
      </div>
    </main>

    <footer class="player">
      <div class="now-playing">
        <div class="np-cover"><img id="npCover" alt="cover"/></div>
        <div class="np-text">
          <div class="np-title" id="npTitle">—</div>
          <div class="np-artist" id="npArtist">—</div>
        </div>
      </div>

      <div class="controls">
        <div class="ctrl-row">
          <button class="btn icon" id="btnShuffle" title="Shuffle" aria-label="Shuffle">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 3 21 3 21 8"></polyline><line x1="4" y1="20" x2="21" y2="3"></line><polyline points="21 16 21 21 16 21"></polyline><line x1="15" y1="15" x2="21" y2="21"></line><line x1="4" y1="4" x2="9" y2="9"></line></svg>
          </button>
          <button class="btn icon" id="btnPrev" title="Prev" aria-label="Prev">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M6 5h2v14H6z"/><path d="M20 18L9 12l11-6z"/></svg>
          </button>
          <button class="btn play" id="btnPlay" title="Play/Pause" aria-label="Play/Pause">
            <svg id="iconPlay" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
            <svg id="iconPause" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display:none"><path d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
          </button>
          <button class="btn icon" id="btnNext" title="Next" aria-label="Next">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M16 5h2v14h-2z"/><path d="M4 6l11 6-11 6z"/></svg>
          </button>
          <button class="btn icon" id="btnRepeat" title="Repeat" aria-label="Repeat">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="17 1 21 5 17 9"/><path d="M3 11a9 9 0 0 1 14-7h4"/><polyline points="7 23 3 19 7 15"/><path d="M21 13a9 9 0 0 1-14 7H3"/></svg>
          </button>
        </div>
        <div class="seek">
          <span id="curTime">0:00</span>
          <div class="bar" id="seekBar" aria-label="Progress">
            <div class="bar-fill" id="seekFill"></div>
            <div class="knob" id="seekKnob"></div>
          </div>
          <span id="totalTime">0:00</span>
        </div>
      </div>

      <div class="right">
        <div class="volume">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M4 9v6h4l5 5V4L8 9H4z"/></svg>
          <div class="bar" id="volBar" aria-label="Volume">
            <div class="bar-fill" id="volFill" style="width:80%"></div>
            <div class="knob" id="volKnob" style="left:80%"></div>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <audio id="audio"></audio>

  <script>
    // === Tambahkan lagu manual di sini ===
    // Letakkan file Anda sendiri di folder /audio dan /covers (atau ubah path). Durasi ditampilkan dari field 'duration'.
    const tracks = [
      {
        id: 1,
        title: "TABOLA BALE x CALON MANTU",
        artist: "Maman FVNDY",
        duration: "3:14",
        src: "TABOLA BALE x CALON MANTU.mp3", // ganti dengan file Anda
        cover: "TABOLA BALE.png", // ganti dengan cover Anda
        artwork: "TABOLA BALE.png"
      },
      {
        id: 2,
        title: "DJ FIGURINHA OLD",
        artist: "Dirga YETE",
        duration: "5:02",
        src: "DJ FIGURINHA OLD.mp3",
        cover: "FIgurinha  Remix.png",
        artwork: "FIgurinha  Remix.png"
      },
      {
        id: 3,
        title: "DJ SUDAH TERBIASA TERJADI TANTE",
        artist: "AURORA",
        duration: "7:25",
        src: "DJ SUDAH TERBIASA TERJADI TANTE.mp3",
        cover: "DJ SUDAH TERBIASA TERJADI TANTE.png",
        artwork: "DJ SUDAH TERBIASA TERJADI TANTE.png"
      },
      {
        id: 4,
        title: "DJ AKU DAH LUPA X GARAM DAN MADU",
        artist: "8bit Lab",
        duration: "3:38",
        src: "DJ AKU DAH LUPA X GARAM DAN MADU.mp3",
        cover: "DJ AKU DAH LUPA X GARAM DAN MADU.png",
        artwork: "DJ AKU DAH LUPA X GARAM DAN MADU.png"
      }
    ];

    // ====== STATE ======
    let currentIndex = 0;
    let isPlaying = false;
    let isShuffle = false;
    let isRepeat = false;

    const audio = document.getElementById('audio');

    // ====== DOM ======
    const playlistBody = document.getElementById('playlistBody');
    const totalCount = document.getElementById('totalCount');

    const npCover = document.getElementById('npCover');
    const npTitle = document.getElementById('npTitle');
    const npArtist = document.getElementById('npArtist');

    const btnPlay = document.getElementById('btnPlay');
    const iconPlay = document.getElementById('iconPlay');
    const iconPause = document.getElementById('iconPause');
    const btnPrev = document.getElementById('btnPrev');
    const btnNext = document.getElementById('btnNext');
    const btnShuffle = document.getElementById('btnShuffle');
    const btnRepeat = document.getElementById('btnRepeat');

    const curTime = document.getElementById('curTime');
    const totalTime = document.getElementById('totalTime');
    const seekBar = document.getElementById('seekBar');
    const seekFill = document.getElementById('seekFill');
    const seekKnob = document.getElementById('seekKnob');

    const volBar = document.getElementById('volBar');
    const volFill = document.getElementById('volFill');
    const volKnob = document.getElementById('volKnob');

    const search = document.getElementById('search');

    // ====== HELPERS ======
    const fmt = (sec) => {
      if (!isFinite(sec)) return '0:00';
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${s.toString().padStart(2,'0')}`;
    }

    function renderPlaylist(list = tracks) {
      playlistBody.innerHTML = '';
      list.forEach((t, i) => {
        const tr = document.createElement('tr');
        tr.dataset.index = i;
        tr.innerHTML = `
          <td style="color:var(--muted); font-variant-numeric: tabular-nums">${i+1}</td>
          <td>
            <div class="track">
              <div class="cover"><img src="${t.cover}" alt="${t.title}" loading="lazy"/></div>
              <div class="meta">
                <div class="title">${t.title}</div>
                <div class="artist">${t.artist}</div>
              </div>
            </div>
          </td>
          <td class="duration">${t.duration}</td>
        `;
        tr.addEventListener('click', () => {
          const realIndex = tracks.indexOf(t); // handle filter mapping
          loadTrack(realIndex);
          play();
        });
        playlistBody.appendChild(tr);
      });
      totalCount.textContent = `${list.length} lagu`;
    }

    function loadTrack(index) {
      const t = tracks[index];
      if (!t) return;
      currentIndex = index;
      audio.src = t.src;
      npCover.src = t.cover;
      npTitle.textContent = t.title;
      npArtist.textContent = t.artist;
      totalTime.textContent = t.duration || '0:00';
      highlightActiveRow();

      // Update Media Session dengan artwork yang benar
      if ('mediaSession' in navigator) {
        navigator.mediaSession.metadata = new MediaMetadata({
          title: t.title,
          artist: t.artist,
          album: 'Portfolio Music Player',
          artwork: [
            { src: t.artwork, sizes: '96x96', type: 'image/png' },
            { src: t.artwork, sizes: '128x128', type: 'image/png' },
            { src: t.artwork, sizes: '256x256', type: 'image/png' },
            { src: t.artwork, sizes: '512x512', type: 'image/png' }
          ]
        });

        // Set handlers dan state
        navigator.mediaSession.playbackState = isPlaying ? 'playing' : 'paused';
        navigator.mediaSession.setActionHandler('play', () => {
          play();
          navigator.mediaSession.playbackState = 'playing';
        });
        navigator.mediaSession.setActionHandler('pause', () => {
          pause();
          navigator.mediaSession.playbackState = 'paused';
        });
        navigator.mediaSession.setActionHandler('previoustrack', prev);
        navigator.mediaSession.setActionHandler('nexttrack', next);
        navigator.mediaSession.setActionHandler('seekto', (details) => {
          audio.currentTime = details.seekTime;
        });
      }
    }

    function highlightActiveRow() {
      [...playlistBody.children].forEach((row, i) => {
        const realIndex = Number(row.dataset.index);
        const track = [...tracks][realIndex];
        const isActive = tracks.indexOf(track) === currentIndex;
        row.style.background = isActive ? 'rgba(29,185,84,.12)' : '';
      });
    }

    function play() {
      audio.play().then(() => {
        isPlaying = true;
        btnPlay.classList.add('toggled');
        iconPlay.style.display = 'none';
        iconPause.style.display = 'block';
      }).catch(console.warn);
    }
    function pause() {
      audio.pause();
      isPlaying = false;
      btnPlay.classList.remove('toggled');
      iconPlay.style.display = 'block';
      iconPause.style.display = 'none';
    }

    function togglePlay(){ isPlaying ? pause() : play(); }

    function next() {
      if (isShuffle) {
        let ni = Math.floor(Math.random() * tracks.length);
        if (ni === currentIndex && tracks.length > 1) ni = (ni + 1) % tracks.length;
        loadTrack(ni);
      } else {
        loadTrack((currentIndex + 1) % tracks.length);
      }
      play();
    }

    function prev() {
      loadTrack((currentIndex - 1 + tracks.length) % tracks.length);
      play();
    }

    // Seek logic
    function updateSeek() {
      const p = (audio.currentTime / (audio.duration || 1)) * 100;
      seekFill.style.width = p + '%';
      seekKnob.style.left = p + '%';
      curTime.textContent = fmt(audio.currentTime);
      if (isFinite(audio.duration)) totalTime.textContent = fmt(audio.duration);
    }

    function setSeekFromEvent(e) {
      const rect = seekBar.getBoundingClientRect();
      const ratio = Math.min(Math.max(0, (e.clientX - rect.left) / rect.width), 1);
      audio.currentTime = ratio * (audio.duration || 0);
      updateSeek();
    }

    // Volume
    function setVolumeFromEvent(e) {
      const rect = volBar.getBoundingClientRect();
      const ratio = Math.min(Math.max(0, (e.clientX - rect.left) / rect.width), 1);
      audio.volume = ratio;
      volFill.style.width = (ratio * 100) + '%';
      volKnob.style.left = (ratio * 100) + '%';
    }

    // Search filter
    function applySearch() {
      const q = search.value.toLowerCase().trim();
      if (!q) return renderPlaylist(tracks);
      const filtered = tracks.filter(t =>
        t.title.toLowerCase().includes(q) || t.artist.toLowerCase().includes(q)
      );
      renderPlaylist(filtered);
    }

    // ====== EVENTS ======
    btnPlay.addEventListener('click', togglePlay);
    btnNext.addEventListener('click', next);
    btnPrev.addEventListener('click', prev);

    btnShuffle.addEventListener('click', () => {
      isShuffle = !isShuffle;
      btnShuffle.style.color = isShuffle ? 'var(--brand)' : 'var(--text)';
    });
    btnRepeat.addEventListener('click', () => {
      isRepeat = !isRepeat;
      btnRepeat.style.color = isRepeat ? 'var(--brand)' : 'var(--text)';
    });

    audio.addEventListener('timeupdate', updateSeek);
    audio.addEventListener('ended', () => {
      if (isRepeat) { audio.currentTime = 0; play(); } else { next(); }
    });

    seekBar.addEventListener('click', setSeekFromEvent);
    let seeking = false;
    seekBar.addEventListener('mousedown', (e) => { seeking = true; setSeekFromEvent(e); });
    window.addEventListener('mousemove', (e) => { if (seeking) setSeekFromEvent(e); });
    window.addEventListener('mouseup', () => { seeking = false; });

    volBar.addEventListener('click', setVolumeFromEvent);
    let volDragging = false;
    volBar.addEventListener('mousedown', (e) => { volDragging = true; setVolumeFromEvent(e); });
    window.addEventListener('mousemove', (e) => { if (volDragging) setVolumeFromEvent(e); });
    window.addEventListener('mouseup', () => { volDragging = false; });

    search.addEventListener('input', applySearch);

    // Keyboard shortcuts
    window.addEventListener('keydown', (e) => {
      if (e.code === 'Space') { e.preventDefault(); togglePlay(); }
      if (e.code === 'ArrowRight') audio.currentTime = Math.min((audio.duration||0), audio.currentTime + 5);
      if (e.code === 'ArrowLeft') audio.currentTime = Math.max(0, audio.currentTime - 5);
    });

    // Init
    audio.volume = 0.8;
    renderPlaylist(tracks);
    loadTrack(0);
  </script>
</body>

</html>

